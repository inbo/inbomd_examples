box: inbobmk/inbomd
build:
  steps:
    - script:
        code: |
          Rscript -e 'remotes::install_github("inbo/INBOmd")'
          export TEXMFHOME=/usr/local/lib/R/site-library/INBOmd/local_tex
          cp /root/.fonts/*.ttf /usr/local/lib/R/site-library/INBOmd/local_tex/fonts/truetype
          Rscript -e 'tinytex::tlmgr_conf(c("auxtrees", "add", system.file("local_tex", package = "INBOmd")))'
          fc-cache -fv
          updmap-sys
          Rscript source/render_all.R

deploy:
  steps:
    - script:
        code: |
          zip -r website.zip docs
          curl -H "Content-Type: application/zip" \
               -H "Authorization: Bearer $NETLIFY_KEY" \
               --data-binary "@website.zip" \
               https://api.netlify.com/api/v1/sites/$NETLIFY_SITEID/deploys
